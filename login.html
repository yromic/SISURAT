<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login | SISURAT</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:opsz@14..32&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }
    </style>
  </head>
  <body class="bg-[#EEEEEE] min-h-screen flex items-center justify-center p-4">
    <div
      class="w-full max-w-5xl bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col md:flex-row animate-fade-in"
    >
      <div
        class="md:w-1/2 bg-gradient-to-br from-[#222831] to-[#393E46] p-8 md:p-12 flex flex-col justify-center items-center text-white relative overflow-hidden"
      >
        <div
          class="absolute top-0 left-0 w-40 h-40 bg-[#00ADB5] opacity-20 rounded-full -translate-x-1/2 -translate-y-1/2"
        ></div>
        <div
          class="absolute bottom-0 right-0 w-60 h-60 bg-[#00ADB5] opacity-10 rounded-full translate-x-1/3 translate-y-1/3"
        ></div>

        <div class="relative z-10 text-center">
          <div class="mb-6 flex justify-center">
            <div class="bg-[#00ADB5] p-4 rounded-2xl shadow-lg inline-block">
              <i class="fas fa-folder-open text-5xl text-white"></i>
            </div>
          </div>
          <h2 class="text-3xl md:text-4xl font-bold mb-2">SISURAT</h2>
          <p
            class="text-[#EEEEEE] text-opacity-80 text-sm md:text-base max-w-xs mx-auto"
          >
            Sistem Manajemen Surat & Piagam yang terintegrasi dan mudah
            digunakan.
          </p>

          <div class="mt-8 border-t border-white border-opacity-20 pt-6">
            <div
              class="flex items-center justify-center gap-1 text-[#00ADB5] mb-2"
            >
              <i class="fas fa-star"></i>
              <i class="fas fa-star"></i>
              <i class="fas fa-star"></i>
              <i class="fas fa-star"></i>
              <i class="fas fa-star"></i>
            </div>
            <p class="text-xs text-white text-opacity-70">
              “Memudahkan pengarsipan surat dan piagam”
            </p>
          </div>
        </div>
      </div>

      <div class="md:w-1/2 p-8 md:p-12 bg-white">
        <div class="max-w-sm mx-auto w-full">
          <h3
            class="text-2xl font-bold text-[#222831] mb-2 flex items-center gap-2"
          >
            <i class="fas fa-lock text-[#00ADB5]"></i> Login
          </h3>
          <p class="text-sm text-[#393E46] mb-8">
            Masuk ke akun Anda untuk mengakses dashboard.
          </p>

          <div class="space-y-5">
            <div>
              <label class="block text-sm font-medium text-[#393E46] mb-1">
                <i class="fas fa-user mr-1 text-[#00ADB5]"></i> Username
              </label>
              <input
                id="username"
                type="text"
                placeholder="Masukkan username"
                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#00ADB5] focus:ring-2 focus:ring-[#00ADB5] focus:ring-opacity-20 outline-none transition"
              />
            </div>

            <div>
              <label class="block text-sm font-medium text-[#393E46] mb-1">
                <i class="fas fa-key mr-1 text-[#00ADB5]"></i> Password
              </label>
              <input
                id="password"
                type="password"
                placeholder="••••••••"
                class="w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-[#00ADB5] focus:ring-2 focus:ring-[#00ADB5] focus:ring-opacity-20 outline-none transition"
              />
            </div>

            <div
              id="msg"
              class="hidden items-center gap-2 text-sm text-red-500 bg-red-50 p-3 rounded-lg"
            >
              <i class="fas fa-exclamation-circle"></i>
              <span></span>
            </div>

            <button
              onclick="login()"
              class="w-full bg-[#00ADB5] hover:bg-[#00939c] text-white font-semibold py-3 rounded-xl shadow-lg transition-all duration-200 flex items-center justify-center gap-2"
            >
              <i class="fas fa-sign-in-alt"></i> Masuk
            </button>

            <div class="text-center text-sm text-[#393E46] mt-4">
              <a
                href="index.html"
                class="hover:text-[#00ADB5] transition flex items-center justify-center gap-1"
              >
                <i class="fas fa-arrow-left text-xs"></i> Kembali ke Beranda
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="js/app.js"></script>
    <script>
      async function login(event) {
        if (event) {
          event.preventDefault();
        }

        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;
        const msgDiv = document.getElementById("msg");
        const msgSpan = msgDiv.querySelector("span");

        if (!username || !password) {
          msgDiv.classList.remove("hidden");
          msgSpan.innerText = "Username dan password harus diisi!";
          return;
        }

        const loginBtn = event
          ? event.currentTarget
          : document.querySelector("button");
        const originalText = loginBtn.innerHTML;
        loginBtn.innerHTML =
          '<i class="fas fa-spinner fa-spin"></i> Memproses...';
        loginBtn.disabled = true;

        try {
          const res = await fetch(BASE_URL, {
            method: "POST",

            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
            body: JSON.stringify({
              action: "login",
              data: { username, password },
            }),
          });

          const result = await res.json();

          if (result.status === "success") {
            localStorage.setItem("user", JSON.stringify(result.user));
            window.location.href = "dashboard.html";
          } else {
            msgDiv.classList.remove("hidden");
            msgSpan.innerText =
              result.message ||
              "Login gagal. Periksa kembali username/password.";
          }
        } catch (error) {
          console.error("Detail Error:", error);
          msgDiv.classList.remove("hidden");
          msgSpan.innerText = "Terjadi kesalahan jaringan.";
        } finally {
          loginBtn.innerHTML = originalText;
          loginBtn.disabled = false;
        }
      }

      document
        .getElementById("username")
        .addEventListener("input", function () {
          document.getElementById("msg").classList.add("hidden");
        });
      document
        .getElementById("password")
        .addEventListener("input", function () {
          document.getElementById("msg").classList.add("hidden");
        });
    </script>
  </body>
</html>
